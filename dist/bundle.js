!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"undefined"!=typeof self&&self,e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=3)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=t.Layout=function e(){r(this,e);for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];this.attributes=n;var o=0,s=0,u=!0,l=!1,c=void 0;try{for(var f,h=n[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value;if(this[d.key])throw new a(d);o%d.sizeOfType!=0&&(o+=d.sizeOfType-o%d.sizeOfType),this[d.key]={attribute:d,size:d.size,type:d.type,normalized:d.normalized,offset:o},o+=d.sizeInBytes,s=Math.max(s,d.sizeOfType)}}catch(e){l=!0,c=e}finally{try{!u&&h.return&&h.return()}finally{if(l)throw c}}o%s!=0&&(o+=s-o%s),this.stride=o;var p=!0,m=!1,b=void 0;try{for(var v,g=n[Symbol.iterator]();!(p=(v=g.next()).done);p=!0)this[v.value.key].stride=this.stride}catch(e){m=!0,b=e}finally{try{!p&&g.return&&g.return()}finally{if(m)throw b}}},a=function e(t){r(this,e),this.message="found duplicate attribute: "+t.key},o=function e(t,n,i){arguments.length>3&&void 0!==arguments[3]&&arguments[3],r(this,e),this.key=t,this.size=n,this.type=i,this.normalized=!1,this.sizeOfType=function(e){switch(i){case"BYTE":case"UNSIGNED_BYTE":return 1;case"SHORT":case"UNSIGNED_SHORT":return 2;case"FLOAT":return 4}}(),this.sizeInBytes=this.sizeOfType*n};i.POSITION=new o("position",3,"FLOAT"),i.NORMAL=new o("normal",3,"FLOAT"),i.TANGENT=new o("tangent",3,"FLOAT"),i.BITANGENT=new o("bitangent",3,"FLOAT"),i.UV=new o("uv",2,"FLOAT"),i.MATERIAL_INDEX=new o("materialIndex",1,"SHORT"),i.MATERIAL_ENABLED=new o("materialEnabled",1,"UNSIGNED_SHORT"),i.AMBIENT=new o("ambient",3,"FLOAT"),i.DIFFUSE=new o("diffuse",3,"FLOAT"),i.SPECULAR=new o("specular",3,"FLOAT"),i.SPECULAR_EXPONENT=new o("specularExponent",3,"FLOAT"),i.EMISSIVE=new o("emissive",3,"FLOAT"),i.TRANSMISSION_FILTER=new o("transmissionFilter",3,"FLOAT"),i.DISSOLVE=new o("dissolve",1,"FLOAT"),i.ILLUMINATION=new o("illumination",1,"UNSIGNED_SHORT"),i.REFRACTION_INDEX=new o("refractionIndex",1,"FLOAT"),i.SHARPNESS=new o("sharpness",1,"FLOAT"),i.MAP_DIFFUSE=new o("mapDiffuse",1,"SHORT"),i.MAP_AMBIENT=new o("mapAmbient",1,"SHORT"),i.MAP_SPECULAR=new o("mapSpecular",1,"SHORT"),i.MAP_SPECULAR_EXPONENT=new o("mapSpecularExponent",1,"SHORT"),i.MAP_DISSOLVE=new o("mapDissolve",1,"SHORT"),i.ANTI_ALIASING=new o("antiAliasing",1,"UNSIGNED_SHORT"),i.MAP_BUMP=new o("mapBump",1,"SHORT"),i.MAP_DISPLACEMENT=new o("mapDisplacement",1,"SHORT"),i.MAP_DECAL=new o("mapDecal",1,"SHORT"),i.MAP_EMISSIVE=new o("mapEmissive",1,"SHORT")},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),o=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),(n=n||{}).materials=n.materials||{},n.enableWTextureCoord=!!n.enableWTextureCoord,n.indicesPerMaterial=!!n.indicesPerMaterial;var i=this;i.vertices=[],i.vertexNormals=[],i.textures=[],i.indices=[],i.textureStride=n.enableWTextureCoord?3:2,this.name="";var a=[],o=[],s=[],u={},l=[],c={},f=-1,h=0;u.verts=[],u.norms=[],u.textures=[],u.hashindices={},u.indices=[[]],u.materialIndices=[],u.index=0;for(var d=/^v\s/,p=/^vn\s/,m=/^vt\s/,b=/^f\s/,v=/\s+/,g=/^usemtl/,M=t.split("\n"),y=0;y<M.length;y++){var x=M[y].trim();if(x&&!x.startsWith("#")){var A=x.split(v);if(A.shift(),d.test(x))a.push.apply(a,r(A));else if(p.test(x))o.push.apply(o,r(A));else if(m.test(x)){var _=A;A.length>2&&!n.enableWTextureCoord?_=A.slice(0,2):2===A.length&&n.enableWTextureCoord&&_.push(0),s.push.apply(s,r(_))}else if(g.test(x)){var T=A[0];T in c||(l.push(T),c[T]=l.length-1,n.indicesPerMaterial&&c[T]>0&&u.indices.push([])),f=c[T],n.indicesPerMaterial&&(h=f)}else if(b.test(x))for(var E=!1,R=0,S=A.length;R<S;R++){3!==R||E||(R=2,E=!0);var I=A[0]+","+f,w=A[R]+","+f;if(w in u.hashindices)u.indices[h].push(u.hashindices[w]);else{var L=A[R].split("/"),N=L.length-1;if(u.verts.push(+a[3*(L[0]-1)+0]),u.verts.push(+a[3*(L[0]-1)+1]),u.verts.push(+a[3*(L[0]-1)+2]),s.length){var O=n.enableWTextureCoord?3:2;u.textures.push(+s[(L[1]-1)*O+0]),u.textures.push(+s[(L[1]-1)*O+1]),n.enableWTextureCoord&&u.textures.push(+s[(L[1]-1)*O+2])}u.norms.push(+o[3*(L[N]-1)+0]),u.norms.push(+o[3*(L[N]-1)+1]),u.norms.push(+o[3*(L[N]-1)+2]),u.materialIndices.push(f),u.hashindices[w]=u.index,u.indices[h].push(u.hashindices[w]),u.index+=1}3===R&&E&&u.indices[h].push(u.hashindices[I])}}}i.vertices=u.verts,i.vertexNormals=u.norms,i.textures=u.textures,i.vertexMaterialIndices=u.materialIndices,i.indices=n.indicesPerMaterial?u.indices:u.indices[h],i.materialNames=l,i.materialIndices=c,i.materialsByIndex={},n.calcTangentsAndBitangents&&this.calculateTangentsAndBitangents()}return i(e,[{key:"calculateTangentsAndBitangents",value:function(){var e={};e.tangents=[].concat(r(new Array(this.vertices.length))).map(function(e){return 0}),e.bitangents=[].concat(r(new Array(this.vertices.length))).map(function(e){return 0});var t;t=Array.isArray(this.indices[0])?[].concat.apply([],this.indices):this.indices;for(var n=this.vertices,i=this.vertexNormals,a=this.textures,o=0;o<t.length;o+=3){var s=t[o+0],u=t[o+1],l=t[o+2],c=n[3*s+0],f=n[3*s+1],h=n[3*s+2],d=a[2*s+0],p=a[2*s+1],m=n[3*u+0],b=n[3*u+1],v=n[3*u+2],g=a[2*u+0],M=a[2*u+1],y=m-c,x=b-f,A=v-h,_=n[3*l+0]-c,T=n[3*l+1]-f,E=n[3*l+2]-h,R=g-d,S=M-p,I=a[2*l+0]-d,w=a[2*l+1]-p,L=R*w-S*I,N=1/(Math.abs(L<1e-4)?1:L),O=(y*w-_*S)*N,F=(x*w-T*S)*N,B=(A*w-E*S)*N,C=(_*R-y*I)*N,P=(T*R-x*I)*N,k=(E*R-A*I)*N,V=i[3*s+0],D=i[3*s+1],U=i[3*s+2],z=i[3*u+0],q=i[3*u+1],H=i[3*u+2],G=i[3*l+0],X=i[3*l+1],Y=i[3*l+2],W=O*V+F*D+B*U,j=O*z+F*q+B*H,K=O*G+F*X+B*Y,Q=O-V*W,Z=F-D*W,$=B-U*W,J=O-z*j,ee=F-q*j,te=B-H*j,ne=O-G*K,re=F-X*K,ie=B-Y*K,ae=Math.sqrt(Q*Q+Z*Z+$*$),oe=Math.sqrt(J*J+ee*ee+te*te),se=Math.sqrt(ne*ne+re*re+ie*ie),ue=C*V+P*D+k*U,le=C*z+P*q+k*H,ce=C*G+P*X+k*Y,fe=C-V*ue,he=P-D*ue,de=k-U*ue,pe=C-z*le,me=P-q*le,be=k-H*le,ve=C-G*ce,ge=P-X*ce,Me=k-Y*ce,ye=Math.sqrt(fe*fe+he*he+de*de),xe=Math.sqrt(pe*pe+me*me+be*be),Ae=Math.sqrt(ve*ve+ge*ge+Me*Me);e.tangents[3*s+0]+=Q/ae,e.tangents[3*s+1]+=Z/ae,e.tangents[3*s+2]+=$/ae,e.tangents[3*u+0]+=J/oe,e.tangents[3*u+1]+=ee/oe,e.tangents[3*u+2]+=te/oe,e.tangents[3*l+0]+=ne/se,e.tangents[3*l+1]+=re/se,e.tangents[3*l+2]+=ie/se,e.bitangents[3*s+0]+=fe/ye,e.bitangents[3*s+1]+=he/ye,e.bitangents[3*s+2]+=de/ye,e.bitangents[3*u+0]+=pe/xe,e.bitangents[3*u+1]+=me/xe,e.bitangents[3*u+2]+=be/xe,e.bitangents[3*l+0]+=ve/Ae,e.bitangents[3*l+1]+=ge/Ae,e.bitangents[3*l+2]+=Me/Ae}this.tangents=e.tangents,this.bitangents=e.bitangents}},{key:"makeBufferData",value:function(e){var t=this.vertices.length/3,n=new ArrayBuffer(e.stride*t);n.numItems=t;for(var r=new DataView(n),i=0,o=0;i<t;i++){o=i*e.stride;var s=!0,u=!1,l=void 0;try{for(var c,f=e.attributes[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var h=c.value,d=o+e[h.key].offset;switch(h.key){case a.Layout.POSITION.key:r.setFloat32(d,this.vertices[3*i],!0),r.setFloat32(d+4,this.vertices[3*i+1],!0),r.setFloat32(d+8,this.vertices[3*i+2],!0);break;case a.Layout.UV.key:r.setFloat32(d,this.textures[2*i],!0),r.setFloat32(d+4,this.vertices[2*i+1],!0);break;case a.Layout.NORMAL.key:r.setFloat32(d,this.vertexNormals[3*i],!0),r.setFloat32(d+4,this.vertexNormals[3*i+1],!0),r.setFloat32(d+8,this.vertexNormals[3*i+2],!0);break;case a.Layout.MATERIAL_INDEX.key:r.setInt16(d,this.vertexMaterialIndices[i],!0);break;case a.Layout.AMBIENT.key:var p=this.vertexMaterialIndices[i],m=this.materialsByIndex[p];if(!m)break;r.setFloat32(d,m.ambient[0],!0),r.setFloat32(d+4,m.ambient[1],!0),r.setFloat32(d+8,m.ambient[2],!0);break;case a.Layout.DIFFUSE.key:var b=this.vertexMaterialIndices[i],v=this.materialsByIndex[b];if(!v)break;r.setFloat32(d,v.diffuse[0],!0),r.setFloat32(d+4,v.diffuse[1],!0),r.setFloat32(d+8,v.diffuse[2],!0);break;case a.Layout.SPECULAR.key:var g=this.vertexMaterialIndices[i],M=this.materialsByIndex[g];if(!M)break;r.setFloat32(d,M.specular[0],!0),r.setFloat32(d+4,M.specular[1],!0),r.setFloat32(d+8,M.specular[2],!0);break;case a.Layout.SPECULAR_EXPONENT.key:var y=this.vertexMaterialIndices[i],x=this.materialsByIndex[y];if(!x)break;r.setFloat32(d,x.specularExponent,!0);break;case a.Layout.EMISSIVE.key:var A=this.vertexMaterialIndices[i],_=this.materialsByIndex[A];if(!_)break;r.setFloat32(d,_.emissive[0],!0),r.setFloat32(d+4,_.emissive[1],!0),r.setFloat32(d+8,_.emissive[2],!0);break;case a.Layout.TRANSMISSION_FILTER.key:var T=this.vertexMaterialIndices[i],E=this.materialsByIndex[T];if(!E)break;r.setFloat32(d,E.transmissionFilter[0],!0),r.setFloat32(d+4,E.transmissionFilter[1],!0),r.setFloat32(d+8,E.transmissionFilter[2],!0);break;case a.Layout.DISSOLVE.key:var R=this.vertexMaterialIndices[i],S=this.materialsByIndex[R];if(!S)break;r.setFloat32(d,S.dissolve,!0);break;case a.Layout.ILLUMINATION.key:var I=this.vertexMaterialIndices[i],w=this.materialsByIndex[I];if(!w)break;r.setInt16(d,w.illumination,!0);break;case a.Layout.REFRACTION_INDEX.key:var L=this.vertexMaterialIndices[i],N=this.materialsByIndex[L];if(!N)break;r.setFloat32(d,N.refractionIndex,!0);break;case a.Layout.SHARPNESS.key:var O=this.vertexMaterialIndices[i],F=this.materialsByIndex[O];if(!F)break;r.setFloat32(d,F.sharpness,!0);break;case a.Layout.ANTI_ALIASING.key:var B=this.vertexMaterialIndices[i],C=this.materialsByIndex[B];if(!C)break;r.setInt16(d,C.antiAliasing,!0)}}}catch(e){u=!0,l=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw l}}}return n}},{key:"makeIndexBufferData",value:function(){var e=new Uint16Array(this.indices);return e.numItems=this.indices.length,e}},{key:"addMaterialLibrary",value:function(e){for(var t in e.materials)if(t in this.materialIndices){var n=e.materials[t],r=this.materialIndices[n.name];this.materialsByIndex[r]=n}}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return Array.isArray(e)?e:Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t.Material=function e(t){i(this,e),this.name=t,this.ambient=[0,0,0],this.diffuse=[0,0,0],this.specular=[0,0,0],this.emissive=[0,0,0],this.transmissionFilter=[0,0,0],this.dissolve=0,this.specularExponent=0,this.transparency=0,this.illumination=0,this.refractionIndex=1,this.sharpness=0,this.mapDiffuse=null,this.mapAmbient=null,this.mapSpecular=null,this.mapSpecularExponent=null,this.mapDissolve=null,this.antiAliasing=!1,this.mapBump=null,this.mapDisplacement=null,this.mapDecal=null,this.mapEmissive=null,this.mapReflections=[]};t.MaterialLibrary=function(){function e(t){i(this,e),this.data=t,this.currentMaterial=null,this.materials={},this.parse()}return a(e,[{key:"parse_newmtl",value:function(e){var t=e[0];this.currentMaterial=new o(t),this.materials[t]=this.currentMaterial}},{key:"parseColor",value:function(e){if("spectral"!=e[0]&&"xyz"!=e[0]){if(3==e.length)return e.map(parseFloat);var t=parseFloat(e[0]);return[t,t,t]}}},{key:"parse_Ka",value:function(e){this.currentMaterial.ambient=this.parseColor(e)}},{key:"parse_Kd",value:function(e){this.currentMaterial.diffuse=this.parseColor(e)}},{key:"parse_Ks",value:function(e){this.currentMaterial.specular=this.parseColor(e)}},{key:"parse_Ke",value:function(e){this.currentMaterial.emissive=this.parseColor(e)}},{key:"parse_Tf",value:function(e){this.currentMaterial.transmissionFilter=this.parseColor(e)}},{key:"parse_d",value:function(e){this.currentMaterial.dissolve=parseFloat(e.pop())}},{key:"parse_illum",value:function(e){this.currentMaterial.illumination=parseInt(e[0])}},{key:"parse_Ni",value:function(e){this.currentMaterial.refractionIndex=parseFloat(e[0])}},{key:"parse_Ns",value:function(e){this.currentMaterial.specularExponent=parseInt(e[0])}},{key:"parse_sharpness",value:function(e){this.currentMaterial.sharpness=parseInt(e[0])}},{key:"parse_cc",value:function(e,t){t.colorCorrection="on"==e[0]}},{key:"parse_blendu",value:function(e,t){t.horizontalBlending="on"==e[0]}},{key:"parse_blendv",value:function(e,t){t.verticalBlending="on"==e[0]}},{key:"parse_boost",value:function(e,t){t.boostMipMapSharpness=parseFloat(e[0])}},{key:"parse_mm",value:function(e,t){t.modifyTextureMap.brightness=parseFloat(e[0]),t.modifyTextureMap.contrast=parseFloat(e[1])}},{key:"parse_ost",value:function(e,t,n){for(;e.length<3;)e.push(n);t.u=parseFloat(e[0]),t.v=parseFloat(e[1]),t.w=parseFloat(e[2])}},{key:"parse_o",value:function(e,t){this.parse_ost(e,t.offset,0)}},{key:"parse_s",value:function(e,t){this.parse_ost(e,t.scale,1)}},{key:"parse_t",value:function(e,t){this.parse_ost(e,t.turbulence,0)}},{key:"parse_texres",value:function(e,t){t.textureResolution=parseFloat(e[0])}},{key:"parse_clamp",value:function(e,t){t.clamp="on"==e[0]}},{key:"parse_bm",value:function(e,t){t.bumpMultiplier=parseFloat(e[0])}},{key:"parse_imfchan",value:function(e,t){t.imfChan=e[0]}},{key:"parse_type",value:function(e,t){t.reflectionType=e[0]}},{key:"parseOptions",value:function(e){var t={colorCorrection:!1,horizontalBlending:!0,verticalBlending:!0,boostMipMapSharpness:0,modifyTextureMap:{brightness:0,contrast:1},offset:{u:0,v:0,w:0},scale:{u:1,v:1,w:1},turbulence:{u:0,v:0,w:0},clamp:!1,textureResolution:null,bumpMultiplier:1,imfChan:null},n=void 0,r=void 0,i={};for(e.reverse();e.length;){var a=e.pop();a.startsWith("-")?i[n=a.substr(1)]=[]:i[n].push(a)}for(n in i)if(i.hasOwnProperty(n)){r=i[n];var o=this["parse_"+n];o&&o.bind(this)(r,t)}return t}},{key:"parseMap",value:function(e){var t=void 0,n=void 0;if(e[0].startsWith("-"))t=e.pop(),n=e;else{var i=r(e);t=i[0],n=i.slice(1)}return(n=this.parseOptions(n)).filename=t,n}},{key:"parse_map_Ka",value:function(e){this.currentMaterial.mapAmbient=this.parseMap(e)}},{key:"parse_map_Kd",value:function(e){this.currentMaterial.mapDiffuse=this.parseMap(e)}},{key:"parse_map_Ks",value:function(e){this.currentMaterial.mapSpecular=this.parseMap(e)}},{key:"parse_map_Ke",value:function(e){this.currentMaterial.mapEmissive=this.parseMap(e)}},{key:"parse_map_Ns",value:function(e){this.currentMaterial.mapSpecularExponent=this.parseMap(e)}},{key:"parse_map_d",value:function(e){this.currentMaterial.mapDissolve=this.parseMap(e)}},{key:"parse_map_aat",value:function(e){this.currentMaterial.antiAliasing="on"==e[0]}},{key:"parse_map_bump",value:function(e){this.currentMaterial.mapBump=this.parseMap(e)}},{key:"parse_bump",value:function(e){this.parse_map_bump(e)}},{key:"parse_disp",value:function(e){this.currentMaterial.mapDisplacement=this.parseMap(e)}},{key:"parse_decal",value:function(e){this.currentMaterial.mapDecal=this.parseMap(e)}},{key:"parse_refl",value:function(e){this.currentMaterial.mapReflections.push(this.parseMap(e))}},{key:"parse",value:function(){var e=this.data.split(/\r?\n/),t=!0,n=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var s=a.value;if((s=s.trim())&&!s.startsWith("#")){var u,l=s.split(/\s/),c=r(l);u=c[0],l=c.slice(1);var f=this["parse_"+u];f&&f.bind(this)(l)}}}catch(e){n=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}delete this.data,this.currentMaterial=null}}]),e}()},function(e,t,n){e.exports=n(4)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.deleteMeshBuffers=t.initMeshBuffers=t.downloadMeshes=t.downloadModels=t.Layout=t.MaterialLibrary=t.Material=t.Mesh=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),i=n(2),a=n(0),o=n(5);t.Mesh=r.default,t.Material=i.Material,t.MaterialLibrary=i.MaterialLibrary,t.Layout=a.Layout,t.downloadModels=o.downloadModels,t.downloadMeshes=o.downloadMeshes,t.initMeshBuffers=o.initMeshBuffers,t.deleteMeshBuffers=o.deleteMeshBuffers,t.version="1.1.3"},function(e,t,n){"use strict";function r(e,t){var n=["mapDiffuse","mapAmbient","mapSpecular","mapDissolve","mapBump","mapDisplacement","mapDecal","mapEmissive"];t.endsWith("/")||(t+="/");var r=[];for(var i in e.materials)if(e.materials.hasOwnProperty(i)){i=e.materials[i];var a=!0,o=!1,s=void 0;try{for(var u,l=n[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value;!function(e){var n=i[c];if(!n)return"continue";var a=t+n.filename;r.push(fetch(a).then(function(e){if(!e.ok)throw new Error;return e.blob()}).then(function(e){var t=new Image;return t.src=URL.createObjectURL(e),n.texture=t,new Promise(function(e){return t.onload=e})}).catch(function(){}))}()}}catch(e){o=!0,s=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw s}}}return Promise.all(r)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.downloadModels=function(e){var t=[],n=!0,s=!1,u=void 0;try{for(var l,c=e[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){!function(e){var n=[];if(!e.obj)throw new Error('"obj" attribute of model object not set. The .obj file is required to be set in order to use downloadModels()');var i={};i.indicesPerMaterial=!!e.indicesPerMaterial,i.calcTangentsAndBitangents=!!e.calcTangentsAndBitangents;var s=e.name;if(!s){var u=e.obj.split("/");s=u[u.length-1].replace(".obj","")}if(n.push(Promise.resolve(s)),n.push(fetch(e.obj).then(function(e){return e.text()}).then(function(e){return new a.default(e,i)})),e.mtl){var l=e.mtl;"boolean"==typeof l&&(l=e.obj.replace(/\.obj$/,".mtl")),n.push(fetch(l).then(function(e){return e.text()}).then(function(t){var n=new o.MaterialLibrary(t);if(!1!==e.downloadMtlTextures){var i=e.mtlTextureRoot;return i||(i=l.substr(0,l.lastIndexOf("/"))),Promise.all([Promise.resolve(n),r(n,i)])}return Promise.all(Promise.resolve(n))}).then(function(e){return e[0]}))}t.push(Promise.all(n))}(l.value)}}catch(e){s=!0,u=e}finally{try{!n&&c.return&&c.return()}finally{if(s)throw u}}return Promise.all(t).then(function(e){var t={},n=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value,l=i(u,3),c=l[0],f=l[1],h=l[2];f.name=c,h&&f.addMaterialLibrary(h),t[c]=f}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return t})},t.downloadMeshes=function(e,t,n){void 0===n&&(n={});var r=[];for(var o in e)!function(t){if(!e.hasOwnProperty(t))return"continue";var n=e[t];r.push(fetch(n).then(function(e){return e.text()}).then(function(e){return[t,new a.default(e)]}))}(o);Promise.all(r).then(function(e){var r=!0,a=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value,c=i(l,2),f=c[0],h=c[1];n[f]=h}}catch(e){a=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw o}}return t(n)})},t.initMeshBuffers=function(e,t){t.normalBuffer=s(e,e.ARRAY_BUFFER,t.vertexNormals,3),t.textureBuffer=s(e,e.ARRAY_BUFFER,t.textures,t.textureStride),t.vertexBuffer=s(e,e.ARRAY_BUFFER,t.vertices,3),t.indexBuffer=s(e,e.ELEMENT_ARRAY_BUFFER,t.indices,1)},t.deleteMeshBuffers=function(e,t){e.deleteBuffer(t.normalBuffer),e.deleteBuffer(t.textureBuffer),e.deleteBuffer(t.vertexBuffer),e.deleteBuffer(t.indexBuffer)};var a=function(e){return e&&e.__esModule?e:{default:e}}(n(1)),o=n(2),s=(n(0),function(e,t,n,r){var i=e.createBuffer(),a=t===e.ARRAY_BUFFER?Float32Array:Uint16Array;return e.bindBuffer(t,i),e.bufferData(t,new a(n),e.STATIC_DRAW),i.itemSize=r,i.numItems=n.length/r,i})}])},function(e,t){e.exports="\nlayout (location = 0) in vec3 a_position;\n#ifdef HAS_NORMALS\nlayout (location = 1) in vec3 a_normal;\n#endif\n#ifdef HAS_TANGENTS\nlayout (location = 2) in vec4 a_tangent;\n#endif\n#ifdef HAS_UV\nlayout (location = 3) in vec2 a_texcoord_0;\n#endif\n\nuniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nout vec3 v_Position;\nout vec2 v_UV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nout mat3 v_TBN;\n#else\nout vec3 v_Normal;\n#endif\n#endif\n\n\nvoid main()\n{\n  vec4 pos = u_ModelMatrix * vec4(a_position, 1.0);\n  v_Position = vec3(pos.xyz) / pos.w;\n\n  #ifdef HAS_NORMALS\n  #ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(a_normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(a_tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * a_tangent.w;\n  v_TBN = mat3(tangentW, bitangentW, normalW);\n  #else // HAS_TANGENTS != 1\n  v_Normal = normalize(vec3(u_ModelMatrix * vec4(a_normal.xyz, 0.0)));\n  #endif\n  #endif\n\n  #ifdef HAS_UV\n  v_UV = a_texcoord_0;\n  #else\n  v_UV = vec2(0.,0.);\n  #endif\n\n  gl_Position = u_MVPMatrix * vec4(a_position, 1.0); // needs w for proper perspective correction\n}\n"},function(e,t){e.exports="\nprecision highp float;\n\nuniform vec3 u_LightDirection;\nuniform vec3 u_LightColor;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n\n// debugging flags used for shader output of intermediate PBR variables\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\nuniform vec4 u_ScaleIBLAmbient;\n\nin vec3 v_Position;\n\nin vec2 v_UV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nin mat3 v_TBN;\n#else\nin vec3 v_Normal;\n#endif\n#endif\n\nout vec4 FragColor;\n// Encapsulate the various inputs used by the various functions in the shading equation\n// We store values in this struct to simplify the integration of alternative implementations\n// of the shading terms, outlined in the Readme.MD Appendix.\nstruct PBRInfo\n{\n    float NdotL;                  // cos angle between normal and light direction\n    float NdotV;                  // cos angle between normal and view direction\n    float NdotH;                  // cos angle between normal and half vector\n    float LdotH;                  // cos angle between light direction and half vector\n    float VdotH;                  // cos angle between view direction and half vector\n    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\n    float metalness;              // metallic value at the surface\n    vec3 reflectance0;            // full reflectance color (normal incidence angle)\n    vec3 reflectance90;           // reflectance color at grazing angle\n    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\n    vec3 diffuseColor;            // color contribution from diffuse lighting\n    vec3 specularColor;           // color contribution from specular lighting\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n    #ifdef MANUAL_SRGB\n    #ifdef SRGB_FAST_APPROXIMATION\n    vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n    #else //SRGB_FAST_APPROXIMATION\n    vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n    vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n    #endif //SRGB_FAST_APPROXIMATION\n    return vec4(linOut,srgbIn.w);;\n    #else //MANUAL_SRGB\n    return srgbIn;\n    #endif //MANUAL_SRGB\n}\n\n// Find the normal for this fragment, pulling either from a predefined normal map\n// or from the interpolated mesh normal and tangent attributes.\nvec3 getNormal()\n{\n    // Retrieve the tangent space matrix\n#ifndef HAS_TANGENTS\n    vec3 pos_dx = dFdx(v_Position);\n    vec3 pos_dy = dFdy(v_Position);\n    vec3 tex_dx = dFdx(vec3(v_UV, 0.0));\n    vec3 tex_dy = dFdy(vec3(v_UV, 0.0));\n    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n    vec3 ng = normalize(v_Normal);\n#else\n    vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n    t = normalize(t - ng * dot(ng, t));\n    vec3 b = normalize(cross(ng, t));\n    mat3 tbn = mat3(t, b, ng);\n#else // HAS_TANGENTS\n    mat3 tbn = v_TBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n    vec3 n =  texture(u_NormalSampler, v_UV).rgb;\n    n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n    // The tbn matrix is linearly interpolated, so we need to re-normalize\n    vec3 n = normalize(tbn[2].xyz);\n#endif\n\n    return n;\n}\n\n// Calculation of the lighting contribution from an optional Image Based Light source.\n// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].\n// See our README.md on Environment Maps [3] for additional discussion.\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n    float mipCount = 9.0; // resolution of 512x512\n    float lod = (pbrInputs.perceptualRoughness * mipCount);\n    // retrieve a scale and bias to F0. See [1], Figure 3\n    vec3 brdf = SRGBtoLINEAR( texture(u_brdfLUT, vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n    vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n    vec3 specularLight = SRGBtoLINEAR(textureCubeLodEXT(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n    vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n    vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n    vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n\n    // For presentation, this allows us to disable IBL terms\n    diffuse *= u_ScaleIBLAmbient.x;\n    specular *= u_ScaleIBLAmbient.y;\n\n    return diffuse + specular;\n}\n#endif\n\n// Basic Lambertian diffuse\n// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\n// See also [1], Equation 1\nvec3 diffuse(PBRInfo pbrInputs)\n{\n    return pbrInputs.diffuseColor / M_PI;\n}\n\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\n// Implementation of fresnel from [4], Equation 15\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n    return pbrInputs.reflectance0 + (pbrInputs.reflectance90 - pbrInputs.reflectance0) * pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n// This calculates the specular geometric attenuation (aka G()),\n// where rougher material will reflect less light back to the viewer.\n// This implementation is based on [1] Equation 4, and we adopt their modifications to\n// alphaRoughness as input as originally proposed in [2].\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n    float NdotL = pbrInputs.NdotL;\n    float NdotV = pbrInputs.NdotV;\n    float r = pbrInputs.alphaRoughness;\n\n    float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n    float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n    return attenuationL * attenuationV;\n}\n\n// The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\n// Implementation from \"Average Irregularity Representation of a Roughened Surface for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n    float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n    float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n    return roughnessSq / (M_PI * f * f);\n}\n\nvoid main()\n{\n    // Metallic and Roughness material properties are packed together\n    // In glTF, these factors can be specified by fixed scalar values\n    // or from a metallic-roughness map\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\n    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\n    vec4 mrSample =  texture(u_MetallicRoughnessSampler, v_UV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n    // Roughness is authored as perceptual roughness; as is convention,\n    // convert to material roughness by squaring the perceptual roughness [2].\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    // The albedo may be defined from a base texture or a flat color\n#ifdef HAS_BASECOLORMAP\n    vec4 baseColor = SRGBtoLINEAR( texture(u_BaseColorSampler, v_UV)) * u_BaseColorFactor;\n#else\n    vec4 baseColor = u_BaseColorFactor;\n#endif\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n\n    // Compute reflectance.\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n    // For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\n    // For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();                             // normal at surface point\n    vec3 v = normalize(u_Camera - v_Position);        // Vector from surface point to camera\n    vec3 l = normalize(u_LightDirection);             // Vector from surface point to light\n    vec3 h = normalize(l+v);                          // Half vector between both l and v\n    vec3 reflection = -normalize(reflect(v, n));\n\n    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n    PBRInfo pbrInputs = PBRInfo(\n        NdotL,\n        NdotV,\n        NdotH,\n        LdotH,\n        VdotH,\n        perceptualRoughness,\n        metallic,\n        specularEnvironmentR0,\n        specularEnvironmentR90,\n        alphaRoughness,\n        diffuseColor,\n        specularColor\n    );\n\n    // Calculate the shading terms for the microfacet specular shading model\n    vec3 F = specularReflection(pbrInputs);\n    float G = geometricOcclusion(pbrInputs);\n    float D = microfacetDistribution(pbrInputs);\n\n    // Calculation of analytical lighting contribution\n    vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n    vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\n    // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\n    vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\n\n    // Calculate lighting contribution from image based lighting source (IBL)\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n\n    // Apply optional PBR terms for additional (optional) shading\n#ifdef HAS_OCCLUSIONMAP\n    float ao =  texture(u_OcclusionSampler, v_UV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture(u_EmissiveSampler, v_UV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n    // This section uses mix to override final color for reference app visualization\n    // of various parameters in the lighting equation.\n    color = mix(color, F, u_ScaleFGDSpec.x);\n    color = mix(color, vec3(G), u_ScaleFGDSpec.y);\n    color = mix(color, vec3(D), u_ScaleFGDSpec.z);\n    color = mix(color, specContrib, u_ScaleFGDSpec.w);\n\n    color = mix(color, diffuseContrib, u_ScaleDiffBaseMR.x);\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n\n    FragColor = vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n    // FragColor = vec4(n, 1.0);\n}\n"},function(e,t){e.exports={accessors:[{bufferView:0,componentType:5126,count:3575,type:"VEC2"},{bufferView:1,componentType:5126,count:3575,type:"VEC3"},{bufferView:2,componentType:5126,count:3575,type:"VEC4"},{bufferView:3,componentType:5126,count:3575,type:"VEC3",max:[.009921154,.00977163,.0100762453],min:[-.009921154,-.00977163,-.0100762453]},{bufferView:4,componentType:5123,count:18108,type:"SCALAR"},{bufferView:5,componentType:5126,count:875,type:"VEC2"},{bufferView:6,componentType:5126,count:875,type:"VEC3"},{bufferView:7,componentType:5126,count:875,type:"VEC4"},{bufferView:8,componentType:5126,count:875,type:"VEC3",max:[.003958638,.00395863829,.00395863736],min:[-.003958638,-.00395863829,-.00395863736]},{bufferView:9,componentType:5123,count:3420,type:"SCALAR"},{bufferView:10,componentType:5126,count:2252,type:"VEC2"},{bufferView:11,componentType:5126,count:2252,type:"VEC3"},{bufferView:12,componentType:5126,count:2252,type:"VEC4"},{bufferView:13,componentType:5126,count:2252,type:"VEC3",max:[.03458703,.023930205,.00350000383],min:[-.03458703,-.023930205,-.00350000383]},{bufferView:14,componentType:5123,count:11064,type:"SCALAR"},{bufferView:15,componentType:5126,count:1820,type:"VEC2"},{bufferView:16,componentType:5126,count:1820,type:"VEC3"},{bufferView:17,componentType:5126,count:1820,type:"VEC4"},{bufferView:18,componentType:5126,count:1820,type:"VEC3",max:[.0336825922,.02393022,.00350000663],min:[-.0336825848,-.02393022,-.00350000081]},{bufferView:19,componentType:5123,count:8976,type:"SCALAR"},{bufferView:20,componentType:5126,count:1708,type:"VEC2"},{bufferView:21,componentType:5126,count:1708,type:"VEC3"},{bufferView:22,componentType:5126,count:1708,type:"VEC4"},{bufferView:23,componentType:5126,count:1708,type:"VEC3",max:[.03192059,.0239302013,.00350000663],min:[-.03192056,-.02393023,-.00350000081]},{bufferView:24,componentType:5123,count:8496,type:"SCALAR"}],asset:{generator:"glTF Tools for Unity",version:"2.0"},bufferViews:[{buffer:0,byteLength:28600},{buffer:0,byteOffset:28600,byteLength:42900},{buffer:0,byteOffset:71500,byteLength:57200},{buffer:0,byteOffset:128700,byteLength:42900},{buffer:0,byteOffset:171600,byteLength:36216},{buffer:0,byteOffset:207816,byteLength:7e3},{buffer:0,byteOffset:214816,byteLength:10500},{buffer:0,byteOffset:225316,byteLength:14e3},{buffer:0,byteOffset:239316,byteLength:10500},{buffer:0,byteOffset:249816,byteLength:6840},{buffer:0,byteOffset:256656,byteLength:18016},{buffer:0,byteOffset:274672,byteLength:27024},{buffer:0,byteOffset:301696,byteLength:36032},{buffer:0,byteOffset:337728,byteLength:27024},{buffer:0,byteOffset:364752,byteLength:22128},{buffer:0,byteOffset:386880,byteLength:14560},{buffer:0,byteOffset:401440,byteLength:21840},{buffer:0,byteOffset:423280,byteLength:29120},{buffer:0,byteOffset:452400,byteLength:21840},{buffer:0,byteOffset:474240,byteLength:17952},{buffer:0,byteOffset:492192,byteLength:13664},{buffer:0,byteOffset:505856,byteLength:20496},{buffer:0,byteOffset:526352,byteLength:27328},{buffer:0,byteOffset:553680,byteLength:20496},{buffer:0,byteOffset:574176,byteLength:16992}],buffers:[{uri:"BoomBoxWithAxes.bin",byteLength:591168}],images:[{uri:"BoomBoxWithAxes_baseColor.png"},{uri:"BoomBoxWithAxes_roughnessMetallic.png"},{uri:"BoomBoxWithAxes_normal.png"},{uri:"BoomBoxWithAxes_emissive.png"},{uri:"BoomBoxWithAxes_baseColor1.png"}],meshes:[{primitives:[{attributes:{TEXCOORD_0:0,NORMAL:1,TANGENT:2,POSITION:3},indices:4,material:0}],name:"BoomBox"},{primitives:[{attributes:{TEXCOORD_0:5,NORMAL:6,TANGENT:7,POSITION:8},indices:9,material:1}],name:"CoordinateSystem"},{primitives:[{attributes:{TEXCOORD_0:10,NORMAL:11,TANGENT:12,POSITION:13},indices:14,material:1}],name:"X_axis"},{primitives:[{attributes:{TEXCOORD_0:15,NORMAL:16,TANGENT:17,POSITION:18},indices:19,material:1}],name:"Y_axis"},{primitives:[{attributes:{TEXCOORD_0:20,NORMAL:21,TANGENT:22,POSITION:23},indices:24,material:1}],name:"Z_axis"}],materials:[{pbrMetallicRoughness:{baseColorTexture:{index:0},metallicRoughnessTexture:{index:1}},normalTexture:{index:2},emissiveFactor:[1,1,1],emissiveTexture:{index:3},name:"M_BoomBox"},{pbrMetallicRoughness:{baseColorTexture:{index:4},metallicFactor:0,roughnessFactor:.735},name:"M_Coordinates"}],nodes:[{mesh:0,translation:[-1.490116e-9,.002062733,-.000114740425],name:"BoomBox"},{mesh:1,translation:[-.00319974,.0175339244,-.00319973961],name:"CoordinateSystem"},{mesh:2,scale:[.06,.06,.06],translation:[-.010767879,.0143326828,-55000196e-13],name:"X_axis"},{mesh:3,scale:[.06,.06,.06],translation:[.0007127809,.024210168,2.2172928e-7],name:"Y_axis"},{mesh:4,scale:[.06,.06,.06],translation:[.000875492056,.014333982,-.009313311],name:"Z_axis"},{children:[0,1,2,3,4],rotation:[0,1,0,0],name:"BoomBox_Coordinates"}],scene:0,scenes:[{nodes:[5]}],textures:[{source:0},{source:1},{source:2},{source:3},{source:4}]}},function(e,t,n){e.exports=n.p+"d198f3b70862a4c193eaae50fe5d8ad5.bin"},function(e,t,n){e.exports=n.p+"621f6b2e225a34f8fa38fa77e2756af1.png"},function(e,t,n){e.exports=n.p+"09bb3b6f1542db80ad0346c76ce6b69e.png"},function(e,t,n){e.exports=n.p+"34d4ab06a79f8cc82b8d6c998b58a639.png"},function(e,t,n){e.exports=n.p+"363e38fabc0788f8b658eef1e13d4f36.png"},function(e,t,n){e.exports=n.p+"502d4f2edeabbf325e437c4097c8e85b.png"},,,,,function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"EPSILON",function(){return h}),n.d(r,"ARRAY_TYPE",function(){return d}),n.d(r,"RANDOM",function(){return p}),n.d(r,"setMatrixArrayType",function(){return m}),n.d(r,"toRadian",function(){return v}),n.d(r,"equals",function(){return g});var i={};n.r(i),n.d(i,"create",function(){return M}),n.d(i,"clone",function(){return y}),n.d(i,"copy",function(){return x}),n.d(i,"fromValues",function(){return A}),n.d(i,"set",function(){return _}),n.d(i,"identity",function(){return T}),n.d(i,"transpose",function(){return E}),n.d(i,"invert",function(){return R}),n.d(i,"adjoint",function(){return S}),n.d(i,"determinant",function(){return I}),n.d(i,"multiply",function(){return w}),n.d(i,"translate",function(){return L}),n.d(i,"scale",function(){return N}),n.d(i,"rotate",function(){return O}),n.d(i,"rotateX",function(){return F}),n.d(i,"rotateY",function(){return B}),n.d(i,"rotateZ",function(){return C}),n.d(i,"fromTranslation",function(){return P}),n.d(i,"fromScaling",function(){return k}),n.d(i,"fromRotation",function(){return V}),n.d(i,"fromXRotation",function(){return D}),n.d(i,"fromYRotation",function(){return U}),n.d(i,"fromZRotation",function(){return z}),n.d(i,"fromRotationTranslation",function(){return q}),n.d(i,"fromQuat2",function(){return H}),n.d(i,"getTranslation",function(){return G}),n.d(i,"getScaling",function(){return X}),n.d(i,"getRotation",function(){return Y}),n.d(i,"fromRotationTranslationScale",function(){return W}),n.d(i,"fromRotationTranslationScaleOrigin",function(){return j}),n.d(i,"fromQuat",function(){return K}),n.d(i,"frustum",function(){return Q}),n.d(i,"perspective",function(){return Z}),n.d(i,"perspectiveFromFieldOfView",function(){return $}),n.d(i,"ortho",function(){return J}),n.d(i,"lookAt",function(){return ee}),n.d(i,"targetTo",function(){return te}),n.d(i,"str",function(){return ne}),n.d(i,"frob",function(){return re}),n.d(i,"add",function(){return ie}),n.d(i,"subtract",function(){return ae}),n.d(i,"multiplyScalar",function(){return oe}),n.d(i,"multiplyScalarAndAdd",function(){return se}),n.d(i,"exactEquals",function(){return ue}),n.d(i,"equals",function(){return le}),n.d(i,"mul",function(){return ce}),n.d(i,"sub",function(){return fe});var a={};n.r(a),n.d(a,"create",function(){return he}),n.d(a,"clone",function(){return de}),n.d(a,"length",function(){return pe}),n.d(a,"fromValues",function(){return me}),n.d(a,"copy",function(){return be}),n.d(a,"set",function(){return ve}),n.d(a,"add",function(){return ge}),n.d(a,"subtract",function(){return Me}),n.d(a,"multiply",function(){return ye}),n.d(a,"divide",function(){return xe}),n.d(a,"ceil",function(){return Ae}),n.d(a,"floor",function(){return _e}),n.d(a,"min",function(){return Te}),n.d(a,"max",function(){return Ee}),n.d(a,"round",function(){return Re}),n.d(a,"scale",function(){return Se}),n.d(a,"scaleAndAdd",function(){return Ie}),n.d(a,"distance",function(){return we}),n.d(a,"squaredDistance",function(){return Le}),n.d(a,"squaredLength",function(){return Ne}),n.d(a,"negate",function(){return Oe}),n.d(a,"inverse",function(){return Fe}),n.d(a,"normalize",function(){return Be}),n.d(a,"dot",function(){return Ce}),n.d(a,"cross",function(){return Pe}),n.d(a,"lerp",function(){return ke}),n.d(a,"hermite",function(){return Ve}),n.d(a,"bezier",function(){return De}),n.d(a,"random",function(){return Ue}),n.d(a,"transformMat4",function(){return ze}),n.d(a,"transformMat3",function(){return qe}),n.d(a,"transformQuat",function(){return He}),n.d(a,"rotateX",function(){return Ge}),n.d(a,"rotateY",function(){return Xe}),n.d(a,"rotateZ",function(){return Ye}),n.d(a,"angle",function(){return We}),n.d(a,"str",function(){return je}),n.d(a,"exactEquals",function(){return Ke}),n.d(a,"equals",function(){return Qe}),n.d(a,"sub",function(){return Ze}),n.d(a,"mul",function(){return $e}),n.d(a,"div",function(){return Je}),n.d(a,"dist",function(){return et}),n.d(a,"sqrDist",function(){return tt}),n.d(a,"len",function(){return nt}),n.d(a,"sqrLen",function(){return rt}),n.d(a,"forEach",function(){return it});var o={};n.r(o),n.d(o,"create",function(){return at}),n.d(o,"identity",function(){return ot}),n.d(o,"setAxisAngle",function(){return st}),n.d(o,"getAxisAngle",function(){return ut}),n.d(o,"multiply",function(){return lt}),n.d(o,"rotateX",function(){return ct}),n.d(o,"rotateY",function(){return ft}),n.d(o,"rotateZ",function(){return ht}),n.d(o,"calculateW",function(){return dt}),n.d(o,"slerp",function(){return pt}),n.d(o,"random",function(){return mt}),n.d(o,"invert",function(){return bt}),n.d(o,"conjugate",function(){return vt}),n.d(o,"fromMat3",function(){return gt}),n.d(o,"fromEuler",function(){return Mt}),n.d(o,"str",function(){return yt}),n.d(o,"clone",function(){return xt}),n.d(o,"fromValues",function(){return At}),n.d(o,"copy",function(){return _t}),n.d(o,"set",function(){return Tt}),n.d(o,"add",function(){return Et}),n.d(o,"mul",function(){return Rt}),n.d(o,"scale",function(){return St}),n.d(o,"dot",function(){return It}),n.d(o,"lerp",function(){return wt}),n.d(o,"length",function(){return Lt}),n.d(o,"len",function(){return Nt}),n.d(o,"squaredLength",function(){return Ot}),n.d(o,"sqrLen",function(){return Ft}),n.d(o,"normalize",function(){return Bt}),n.d(o,"exactEquals",function(){return Ct}),n.d(o,"equals",function(){return Pt}),n.d(o,"rotationTo",function(){return kt}),n.d(o,"sqlerp",function(){return Vt}),n.d(o,"setAxes",function(){return Dt});var s=n(0);class u{constructor(e,t,n){let r=l(e,e.VERTEX_SHADER,t),i=l(e,e.FRAGMENT_SHADER,n),a=e.createProgram();if(e.attachShader(a,r),e.attachShader(a,i),e.linkProgram(a),e.deleteShader(r),e.deleteShader(i),!e.getProgramParameter(a,e.LINK_STATUS))return console.error("Unable to initialize the shader program: "+e.getProgramInfoLog(a)),null;this.gl=e,this.program=a}use(){this.gl.useProgram(this.program)}setBool(e,t){this.gl.uniform1i(this.gl.getUniformLocation(this.program,e),Number(t))}setInt(e,t){this.gl.uniform1i(this.gl.getUniformLocation(this.program,e),Math.round(Number(t)))}setFloat(e,t){this.gl.uniform1f(this.gl.getUniformLocation(this.program,e),Number(t))}setVec2(e,t){this.gl.uniform2fv(this.gl.getUniformLocation(this.program,e),t)}setVec3(e,t){this.gl.uniform3fv(this.gl.getUniformLocation(this.program,e),t)}setVec4(e,t){this.gl.uniform4fv(this.gl.getUniformLocation(this.program,e),t)}setMat2(e,t){this.gl.uniformMatrix2fv(this.gl.getUniformLocation(this.program,e),!1,t)}setMat3(e,t){this.gl.uniformMatrix3fv(this.gl.getUniformLocation(this.program,e),!1,t)}setMat4(e,t){this.gl.uniformMatrix4fv(this.gl.getUniformLocation(this.program,e),!1,t)}}function l(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:(console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(r)),e.deleteShader(r),null)}class c{constructor({width:e=300,height:t=150,desktopInput:n=!0,touchInput:r=!0}){this.options={width:e,height:t,desktopInput:n,touchInput:r},this.el=document.createElement("div"),this.canvas=document.createElement("canvas"),this.el.style.width=e.toString()+"px",this.el.style.height=t.toString()+"px",this.canvas.style.width=e.toString()+"px",this.canvas.style.height=t.toString()+"px",this.loadingBar=document.createElement("progress"),this.loadingBar.value=0,this.loadingBar.max=100,this.loadingBar.style.width=e+"px",this.el.appendChild(this.loadingBar),this.resource={images:[]},this.resourceCount=0,this.loadProgress=[];let i=this;if(this.loadProgressProxy=new Proxy(this.loadProgress,{set:function(e,t,n,r){let a=i.loadProgress.reduce((e,t)=>e+Number(t),0);return 0!==i.resourceCount&&(i.loadingBar.value=a/i.resourceCount),Reflect.set(e,t,n,r)}}),this.gl=this.canvas.getContext("webgl2"),!this.gl)return console.error("Unable to initialize WebGL2. Your browser or machine may not support it."),null;if(this.deltaTime=0,this.lastFrame=0,function(){let e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}()?this.mobile=!0:this.mobile=!1,this.options.desktopInput){let e={lockPointer:!0};"boolean"!=typeof n&&(e=this.options.desktopInput);let[t,r]=c.desktopInput(this.canvas,e);this.currentlyPressedKeys=t,this.mouseInput=r}if(r){let e=c.touchInput(this.canvas);this.ongoingTouches=e}}resize(){let e=this.canvas.clientWidth,t=this.canvas.clientHeight;this.canvas.width==e&&this.canvas.height==t||(this.canvas.width=e,this.canvas.height=t),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}draw(e){}started(){}render(e){if(this.deltaTime=e-this.lastFrame,this.lastFrame=e,this.resize(),this.draw(e),this.options.touchInput)for(let e in this.ongoingTouches)this.ongoingTouches[e].deltaX=0,this.ongoingTouches[e].deltaY=0;this.options.desktopInput&&(this.mouseInput.deltaX=0,this.mouseInput.deltaY=0,this.mouseInput.wheelDeltaY=0),requestAnimationFrame(this.render.bind(this))}loadMesh(e){let t=new s.Mesh(e);return Object(s.initMeshBuffers)(this.gl,t),t}setMeshVAO(e,t){let n=this.gl.getAttribLocation(t.program,"a_position"),r=this.gl.getAttribLocation(t.program,"a_texCoord"),i=this.gl.getAttribLocation(t.program,"a_normal"),a=this.gl.createVertexArray();return this.gl.bindVertexArray(a),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.vertexBuffer),this.gl.vertexAttribPointer(n,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(n),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.textureBuffer),this.gl.vertexAttribPointer(r,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(r),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e.normalBuffer),this.gl.vertexAttribPointer(i,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(i),this.gl.bindVertexArray(null),a}drawMesh(e,t){this.gl.bindVertexArray(t),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,e.indexBuffer),this.gl.drawElements(this.gl.TRIANGLES,e.indexBuffer.numItems,this.gl.UNSIGNED_SHORT,0),this.gl.bindVertexArray(null)}async start(){let e=await this.loadTexture();this.loadingBar.remove(),this.el.appendChild(this.canvas),this.render(this.lastFrame),this.textures=e,this.started()}setImageResource(e){this.resource.images=e}async loadTexture(){let e=[];this.resourceCount+=this.resource.images.length;let t=this.resource.images.map((e,t)=>c.loadImage(e,e=>{this.loadProgressProxy[t]=e})),n=await Promise.all(t);return this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),n.forEach((t,n)=>{e[n]=this.gl.createTexture(),this.gl.activeTexture(this.gl.TEXTURE0+n),this.gl.bindTexture(this.gl.TEXTURE_2D,e[n]),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR)}),e}}c.loadImage=function(e,t){return new Promise((n,r)=>{let i=new XMLHttpRequest,a=!1;i.open("GET",e,!0),i.responseType="arraybuffer",i.onprogress=function(e){e.lengthComputable?t(Math.round(e.loaded/e.total*100)):a||(a=!0,t(-1))},i.onloadend=function(){if(i.status.toString().match(/^2/)){a||t(100);let e={},r=i.getAllResponseHeaders().match(/^Content-Type\:\s*(.*?)$/im);r&&r[1]&&(e.type=r[1]);let o=new Blob([this.response],e),s=window.URL.createObjectURL(o),u=new Image;u.src=s,u.onload=(()=>n(u))}else r(i)},i.send()})},function(e){e.desktopInput=function(e,t){let n=new Map,r={deltaX:0,deltaY:0,wheelDeltaY:0};function i(e){n.set(e.key,!0)}function a(e){n.set(e.key,!1)}function o(e){r.deltaX=e.movementX||0,r.deltaY=e.movementY||0}function s(e){r.wheelDeltaY=e.wheelDeltaY}function u(){document.addEventListener("keydown",i),document.addEventListener("keyup",a),document.addEventListener("mousemove",o),document.addEventListener("wheel",s)}function l(){document.removeEventListener("keydown",i),document.removeEventListener("keyup",a),document.removeEventListener("mousemove",o),document.removeEventListener("wheel",s)}if(t.lockPointer){function c(){document.pointerLockElement===e||document.mozPointerLockElement===e?u():l()}e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock,e.exitPointerLock=e.exitPointerLock||e.mozExitPointerLock,e.onclick=function(){e.requestPointerLock()},document.addEventListener("pointerlockchange",c,!1),document.addEventListener("mozpointerlockchange",c,!1)}else e.contentEditable="true",e.style.cursor="crosshair",e.addEventListener("focus",u),e.addEventListener("blur",l);return[n,r]},e.touchInput=function(e){const t=[];function n(e){for(let n=0;n<t.length;n++)if(t[n].identifier===e)return n;return-1}return e.addEventListener("touchstart",function(e){e.preventDefault();let n=e.changedTouches;for(let e=0;e<n.length;e++){let r={pageX:n[e].pageX,pageY:n[e].pageY,startX:n[e].pageX,startY:n[e].pageY,deltaX:0,deltaY:0,identifier:n[e].identifier};t.push(r)}},!1),e.addEventListener("touchend",function(e){e.preventDefault();let r=e.changedTouches;for(let e=0;e<r.length;e++){let i=n(r[e].identifier);t.splice(i,1)}},!1),e.addEventListener("touchmove",function(e){e.preventDefault();let r=e.changedTouches;for(let e=0;e<r.length;e++){let i=n(r[e].identifier),a={pageX:r[e].pageX,pageY:r[e].pageY,startX:t[i].startX,startY:t[i].startY,deltaX:r[e].pageX-t[i].pageX,deltaY:r[e].pageY-t[i].pageY,identifier:r[e].identifier};t.splice(i,1,a)}},!1),t}}(c),function(e){const t=[-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0],n="#version 300 es\n\n  layout (location = 0) in vec3 a_position;\n  layout (location = 1) in vec2 a_texCoord;\n\n  out vec2 TexCoord;\n\n  void main()\n  {\n      TexCoord = a_texCoord;\n      gl_Position = vec4(a_position, 1.0);\n  }\n  ";e.prototype.drawQuad=function(e){if(void 0===this.quadVAO){this.quadVAO=this.gl.createVertexArray();let e=this.gl.createBuffer();this.gl.bindVertexArray(this.quadVAO),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.const_DRAW),this.gl.enableVertexAttribArray(0),this.gl.vertexAttribPointer(0,3,this.gl.FLOAT,!0,20,0),this.gl.enableVertexAttribArray(1),this.gl.vertexAttribPointer(1,2,this.gl.FLOAT,!0,20,12),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindVertexArray(null)}if(this.gl.bindVertexArray(this.quadVAO),1===e.length)this.gl.bindTexture(this.gl.TEXTURE_2D,e[0]);else for(let t in e)this.gl.activeTexture(this.gl.TEXTURE0+Number(t)),this.gl.bindTexture(this.gl.TEXTURE_2D,e[t]);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(null)},e.prototype.drawFB=function(e){void 0===this.fbShader&&(this.fbShader=new u(this.gl,n,"#version 300 es\n\n  precision mediump float;\n\n  out vec4 FragColor;\n  in vec2 TexCoord;\n\n  uniform sampler2D scene;\n\n  void main()\n  {\n    FragColor = texture(scene, TexCoord);\n  }\n  ")),this.fbShader.use(),this.fbShader.setInt("scene",0),this.drawQuad([e])},e.prototype.drawDepth=function(e){void 0===this.fbShader&&(this.fbShader=new u(this.gl,n,"#version 300 es\n\n  precision mediump float;\n\n  out vec4 FragColor;\n  in vec2 TexCoord;\n\n  uniform sampler2D depthMap;\n\n  void main()\n  {\n    float depthValue = texture(depthMap, TexCoord).r;\n    FragColor = vec4(vec3(depthValue), 1.0);\n  }\n  ")),this.fbShader.use(),this.fbShader.setInt("depthMap",0),this.drawQuad([e])}}(c);var f=c;const h=1e-6;let d="undefined"!=typeof Float32Array?Float32Array:Array;const p=Math.random;function m(e){d=e}const b=Math.PI/180;function v(e){return e*b}function g(e,t){return Math.abs(e-t)<=h*Math.max(1,Math.abs(e),Math.abs(t))}function M(){let e=new d(16);return d!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function y(e){let t=new d(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function x(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function A(e,t,n,r,i,a,o,s,u,l,c,f,h,p,m,b){let v=new d(16);return v[0]=e,v[1]=t,v[2]=n,v[3]=r,v[4]=i,v[5]=a,v[6]=o,v[7]=s,v[8]=u,v[9]=l,v[10]=c,v[11]=f,v[12]=h,v[13]=p,v[14]=m,v[15]=b,v}function _(e,t,n,r,i,a,o,s,u,l,c,f,h,d,p,m,b){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e[9]=c,e[10]=f,e[11]=h,e[12]=d,e[13]=p,e[14]=m,e[15]=b,e}function T(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function E(e,t){if(e===t){let n=t[1],r=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function R(e,t){let n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],h=t[10],d=t[11],p=t[12],m=t[13],b=t[14],v=t[15],g=n*s-r*o,M=n*u-i*o,y=n*l-a*o,x=r*u-i*s,A=r*l-a*s,_=i*l-a*u,T=c*m-f*p,E=c*b-h*p,R=c*v-d*p,S=f*b-h*m,I=f*v-d*m,w=h*v-d*b,L=g*w-M*I+y*S+x*R-A*E+_*T;return L?(L=1/L,e[0]=(s*w-u*I+l*S)*L,e[1]=(i*I-r*w-a*S)*L,e[2]=(m*_-b*A+v*x)*L,e[3]=(h*A-f*_-d*x)*L,e[4]=(u*R-o*w-l*E)*L,e[5]=(n*w-i*R+a*E)*L,e[6]=(b*y-p*_-v*M)*L,e[7]=(c*_-h*y+d*M)*L,e[8]=(o*I-s*R+l*T)*L,e[9]=(r*R-n*I-a*T)*L,e[10]=(p*A-m*y+v*g)*L,e[11]=(f*y-c*A-d*g)*L,e[12]=(s*E-o*S-u*T)*L,e[13]=(n*S-r*E+i*T)*L,e[14]=(m*M-p*x-b*g)*L,e[15]=(c*x-f*M+h*g)*L,e):null}function S(e,t){let n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],h=t[10],d=t[11],p=t[12],m=t[13],b=t[14],v=t[15];return e[0]=s*(h*v-d*b)-f*(u*v-l*b)+m*(u*d-l*h),e[1]=-(r*(h*v-d*b)-f*(i*v-a*b)+m*(i*d-a*h)),e[2]=r*(u*v-l*b)-s*(i*v-a*b)+m*(i*l-a*u),e[3]=-(r*(u*d-l*h)-s*(i*d-a*h)+f*(i*l-a*u)),e[4]=-(o*(h*v-d*b)-c*(u*v-l*b)+p*(u*d-l*h)),e[5]=n*(h*v-d*b)-c*(i*v-a*b)+p*(i*d-a*h),e[6]=-(n*(u*v-l*b)-o*(i*v-a*b)+p*(i*l-a*u)),e[7]=n*(u*d-l*h)-o*(i*d-a*h)+c*(i*l-a*u),e[8]=o*(f*v-d*m)-c*(s*v-l*m)+p*(s*d-l*f),e[9]=-(n*(f*v-d*m)-c*(r*v-a*m)+p*(r*d-a*f)),e[10]=n*(s*v-l*m)-o*(r*v-a*m)+p*(r*l-a*s),e[11]=-(n*(s*d-l*f)-o*(r*d-a*f)+c*(r*l-a*s)),e[12]=-(o*(f*b-h*m)-c*(s*b-u*m)+p*(s*h-u*f)),e[13]=n*(f*b-h*m)-c*(r*b-i*m)+p*(r*h-i*f),e[14]=-(n*(s*b-u*m)-o*(r*b-i*m)+p*(r*u-i*s)),e[15]=n*(s*h-u*f)-o*(r*h-i*f)+c*(r*u-i*s),e}function I(e){let t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],f=e[10],h=e[11],d=e[12],p=e[13],m=e[14],b=e[15];return(t*o-n*a)*(f*b-h*m)-(t*s-r*a)*(c*b-h*p)+(t*u-i*a)*(c*m-f*p)+(n*s-r*o)*(l*b-h*d)-(n*u-i*o)*(l*m-f*d)+(r*u-i*s)*(l*p-c*d)}function w(e,t,n){let r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],h=t[9],d=t[10],p=t[11],m=t[12],b=t[13],v=t[14],g=t[15],M=n[0],y=n[1],x=n[2],A=n[3];return e[0]=M*r+y*s+x*f+A*m,e[1]=M*i+y*u+x*h+A*b,e[2]=M*a+y*l+x*d+A*v,e[3]=M*o+y*c+x*p+A*g,M=n[4],y=n[5],x=n[6],A=n[7],e[4]=M*r+y*s+x*f+A*m,e[5]=M*i+y*u+x*h+A*b,e[6]=M*a+y*l+x*d+A*v,e[7]=M*o+y*c+x*p+A*g,M=n[8],y=n[9],x=n[10],A=n[11],e[8]=M*r+y*s+x*f+A*m,e[9]=M*i+y*u+x*h+A*b,e[10]=M*a+y*l+x*d+A*v,e[11]=M*o+y*c+x*p+A*g,M=n[12],y=n[13],x=n[14],A=n[15],e[12]=M*r+y*s+x*f+A*m,e[13]=M*i+y*u+x*h+A*b,e[14]=M*a+y*l+x*d+A*v,e[15]=M*o+y*c+x*p+A*g,e}function L(e,t,n){let r,i,a,o,s,u,l,c,f,h,d,p,m=n[0],b=n[1],v=n[2];return t===e?(e[12]=t[0]*m+t[4]*b+t[8]*v+t[12],e[13]=t[1]*m+t[5]*b+t[9]*v+t[13],e[14]=t[2]*m+t[6]*b+t[10]*v+t[14],e[15]=t[3]*m+t[7]*b+t[11]*v+t[15]):(r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],h=t[9],d=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=f,e[9]=h,e[10]=d,e[11]=p,e[12]=r*m+s*b+f*v+t[12],e[13]=i*m+u*b+h*v+t[13],e[14]=a*m+l*b+d*v+t[14],e[15]=o*m+c*b+p*v+t[15]),e}function N(e,t,n){let r=n[0],i=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function O(e,t,n,r){let i,a,o,s,u,l,c,f,d,p,m,b,v,g,M,y,x,A,_,T,E,R,S,I,w=r[0],L=r[1],N=r[2],O=Math.sqrt(w*w+L*L+N*N);return O<h?null:(w*=O=1/O,L*=O,N*=O,i=Math.sin(n),o=1-(a=Math.cos(n)),s=t[0],u=t[1],l=t[2],c=t[3],f=t[4],d=t[5],p=t[6],m=t[7],b=t[8],v=t[9],g=t[10],M=t[11],y=w*w*o+a,x=L*w*o+N*i,A=N*w*o-L*i,_=w*L*o-N*i,T=L*L*o+a,E=N*L*o+w*i,R=w*N*o+L*i,S=L*N*o-w*i,I=N*N*o+a,e[0]=s*y+f*x+b*A,e[1]=u*y+d*x+v*A,e[2]=l*y+p*x+g*A,e[3]=c*y+m*x+M*A,e[4]=s*_+f*T+b*E,e[5]=u*_+d*T+v*E,e[6]=l*_+p*T+g*E,e[7]=c*_+m*T+M*E,e[8]=s*R+f*S+b*I,e[9]=u*R+d*S+v*I,e[10]=l*R+p*S+g*I,e[11]=c*R+m*S+M*I,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function F(e,t,n){let r=Math.sin(n),i=Math.cos(n),a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*r,e[5]=o*i+c*r,e[6]=s*i+f*r,e[7]=u*i+h*r,e[8]=l*i-a*r,e[9]=c*i-o*r,e[10]=f*i-s*r,e[11]=h*i-u*r,e}function B(e,t,n){let r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],u=t[3],l=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*r,e[1]=o*i-c*r,e[2]=s*i-f*r,e[3]=u*i-h*r,e[8]=a*r+l*i,e[9]=o*r+c*i,e[10]=s*r+f*i,e[11]=u*r+h*i,e}function C(e,t,n){let r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],u=t[3],l=t[4],c=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*r,e[1]=o*i+c*r,e[2]=s*i+f*r,e[3]=u*i+h*r,e[4]=l*i-a*r,e[5]=c*i-o*r,e[6]=f*i-s*r,e[7]=h*i-u*r,e}function P(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function k(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function V(e,t,n){let r,i,a,o=n[0],s=n[1],u=n[2],l=Math.sqrt(o*o+s*s+u*u);return l<h?null:(o*=l=1/l,s*=l,u*=l,r=Math.sin(t),a=1-(i=Math.cos(t)),e[0]=o*o*a+i,e[1]=s*o*a+u*r,e[2]=u*o*a-s*r,e[3]=0,e[4]=o*s*a-u*r,e[5]=s*s*a+i,e[6]=u*s*a+o*r,e[7]=0,e[8]=o*u*a+s*r,e[9]=s*u*a-o*r,e[10]=u*u*a+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function D(e,t){let n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function U(e,t){let n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function z(e,t){let n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function q(e,t,n){let r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,u=i+i,l=a+a,c=r*s,f=r*u,h=r*l,d=i*u,p=i*l,m=a*l,b=o*s,v=o*u,g=o*l;return e[0]=1-(d+m),e[1]=f+g,e[2]=h-v,e[3]=0,e[4]=f-g,e[5]=1-(c+m),e[6]=p+b,e[7]=0,e[8]=h+v,e[9]=p-b,e[10]=1-(c+d),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function H(e,t){let n=new d(3),r=-t[0],i=-t[1],a=-t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=r*r+i*i+a*a+o*o;return f>0?(n[0]=2*(s*o+c*r+u*a-l*i)/f,n[1]=2*(u*o+c*i+l*r-s*a)/f,n[2]=2*(l*o+c*a+s*i-u*r)/f):(n[0]=2*(s*o+c*r+u*a-l*i),n[1]=2*(u*o+c*i+l*r-s*a),n[2]=2*(l*o+c*a+s*i-u*r)),q(e,t,n),e}function G(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function X(e,t){let n=t[0],r=t[1],i=t[2],a=t[4],o=t[5],s=t[6],u=t[8],l=t[9],c=t[10];return e[0]=Math.sqrt(n*n+r*r+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(u*u+l*l+c*c),e}function Y(e,t){let n=t[0]+t[5]+t[10],r=0;return n>0?(r=2*Math.sqrt(n+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e}function W(e,t,n,r){let i=t[0],a=t[1],o=t[2],s=t[3],u=i+i,l=a+a,c=o+o,f=i*u,h=i*l,d=i*c,p=a*l,m=a*c,b=o*c,v=s*u,g=s*l,M=s*c,y=r[0],x=r[1],A=r[2];return e[0]=(1-(p+b))*y,e[1]=(h+M)*y,e[2]=(d-g)*y,e[3]=0,e[4]=(h-M)*x,e[5]=(1-(f+b))*x,e[6]=(m+v)*x,e[7]=0,e[8]=(d+g)*A,e[9]=(m-v)*A,e[10]=(1-(f+p))*A,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function j(e,t,n,r,i){let a=t[0],o=t[1],s=t[2],u=t[3],l=a+a,c=o+o,f=s+s,h=a*l,d=a*c,p=a*f,m=o*c,b=o*f,v=s*f,g=u*l,M=u*c,y=u*f,x=r[0],A=r[1],_=r[2],T=i[0],E=i[1],R=i[2],S=(1-(m+v))*x,I=(d+y)*x,w=(p-M)*x,L=(d-y)*A,N=(1-(h+v))*A,O=(b+g)*A,F=(p+M)*_,B=(b-g)*_,C=(1-(h+m))*_;return e[0]=S,e[1]=I,e[2]=w,e[3]=0,e[4]=L,e[5]=N,e[6]=O,e[7]=0,e[8]=F,e[9]=B,e[10]=C,e[11]=0,e[12]=n[0]+T-(S*T+L*E+F*R),e[13]=n[1]+E-(I*T+N*E+B*R),e[14]=n[2]+R-(w*T+O*E+C*R),e[15]=1,e}function K(e,t){let n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,u=i+i,l=n*o,c=r*o,f=r*s,h=i*o,d=i*s,p=i*u,m=a*o,b=a*s,v=a*u;return e[0]=1-f-p,e[1]=c+v,e[2]=h-b,e[3]=0,e[4]=c-v,e[5]=1-l-p,e[6]=d+m,e[7]=0,e[8]=h+b,e[9]=d-m,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Q(e,t,n,r,i,a,o){let s=1/(n-t),u=1/(i-r),l=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e}function Z(e,t,n,r,i){let a,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e}function $(e,t,n,r){let i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(i+a);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(i-a)*l*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function J(e,t,n,r,i,a,o){let s=1/(t-n),u=1/(r-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(o+a)*l,e[15]=1,e}function ee(e,t,n,r){let i,a,o,s,u,l,c,f,d,p,m=t[0],b=t[1],v=t[2],g=r[0],M=r[1],y=r[2],x=n[0],A=n[1],_=n[2];return Math.abs(m-x)<h&&Math.abs(b-A)<h&&Math.abs(v-_)<h?T(e):(c=m-x,f=b-A,d=v-_,i=M*(d*=p=1/Math.sqrt(c*c+f*f+d*d))-y*(f*=p),a=y*(c*=p)-g*d,o=g*f-M*c,(p=Math.sqrt(i*i+a*a+o*o))?(i*=p=1/p,a*=p,o*=p):(i=0,a=0,o=0),s=f*o-d*a,u=d*i-c*o,l=c*a-f*i,(p=Math.sqrt(s*s+u*u+l*l))?(s*=p=1/p,u*=p,l*=p):(s=0,u=0,l=0),e[0]=i,e[1]=s,e[2]=c,e[3]=0,e[4]=a,e[5]=u,e[6]=f,e[7]=0,e[8]=o,e[9]=l,e[10]=d,e[11]=0,e[12]=-(i*m+a*b+o*v),e[13]=-(s*m+u*b+l*v),e[14]=-(c*m+f*b+d*v),e[15]=1,e)}function te(e,t,n,r){let i=t[0],a=t[1],o=t[2],s=r[0],u=r[1],l=r[2],c=i-n[0],f=a-n[1],h=o-n[2],d=c*c+f*f+h*h;d>0&&(c*=d=1/Math.sqrt(d),f*=d,h*=d);let p=u*h-l*f,m=l*c-s*h,b=s*f-u*c;return(d=p*p+m*m+b*b)>0&&(p*=d=1/Math.sqrt(d),m*=d,b*=d),e[0]=p,e[1]=m,e[2]=b,e[3]=0,e[4]=f*b-h*m,e[5]=h*p-c*b,e[6]=c*m-f*p,e[7]=0,e[8]=c,e[9]=f,e[10]=h,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e}function ne(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function re(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function ie(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function ae(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function oe(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function se(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function ue(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function le(e,t){let n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],f=e[9],d=e[10],p=e[11],m=e[12],b=e[13],v=e[14],g=e[15],M=t[0],y=t[1],x=t[2],A=t[3],_=t[4],T=t[5],E=t[6],R=t[7],S=t[8],I=t[9],w=t[10],L=t[11],N=t[12],O=t[13],F=t[14],B=t[15];return Math.abs(n-M)<=h*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(r-y)<=h*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(i-x)<=h*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(a-A)<=h*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(o-_)<=h*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-T)<=h*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(u-E)<=h*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(l-R)<=h*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(c-S)<=h*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(f-I)<=h*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(d-w)<=h*Math.max(1,Math.abs(d),Math.abs(w))&&Math.abs(p-L)<=h*Math.max(1,Math.abs(p),Math.abs(L))&&Math.abs(m-N)<=h*Math.max(1,Math.abs(m),Math.abs(N))&&Math.abs(b-O)<=h*Math.max(1,Math.abs(b),Math.abs(O))&&Math.abs(v-F)<=h*Math.max(1,Math.abs(v),Math.abs(F))&&Math.abs(g-B)<=h*Math.max(1,Math.abs(g),Math.abs(B))}const ce=w,fe=ae;function he(){let e=new d(3);return d!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function de(e){var t=new d(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function pe(e){let t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}function me(e,t,n){let r=new d(3);return r[0]=e,r[1]=t,r[2]=n,r}function be(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function ve(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function ge(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Me(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function ye(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function xe(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function Ae(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function _e(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Te(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function Ee(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function Re(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function Se(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function Ie(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function we(e,t){let n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}function Le(e,t){let n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function Ne(e){let t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function Oe(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Fe(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Be(e,t){let n=t[0],r=t[1],i=t[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function Ce(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Pe(e,t,n){let r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],u=n[2];return e[0]=i*u-a*s,e[1]=a*o-r*u,e[2]=r*s-i*o,e}function ke(e,t,n,r){let i=t[0],a=t[1],o=t[2];return e[0]=i+r*(n[0]-i),e[1]=a+r*(n[1]-a),e[2]=o+r*(n[2]-o),e}function Ve(e,t,n,r,i,a){let o=a*a,s=o*(2*a-3)+1,u=o*(a-2)+a,l=o*(a-1),c=o*(3-2*a);return e[0]=t[0]*s+n[0]*u+r[0]*l+i[0]*c,e[1]=t[1]*s+n[1]*u+r[1]*l+i[1]*c,e[2]=t[2]*s+n[2]*u+r[2]*l+i[2]*c,e}function De(e,t,n,r,i,a){let o=1-a,s=o*o,u=a*a,l=s*o,c=3*a*s,f=3*u*o,h=u*a;return e[0]=t[0]*l+n[0]*c+r[0]*f+i[0]*h,e[1]=t[1]*l+n[1]*c+r[1]*f+i[1]*h,e[2]=t[2]*l+n[2]*c+r[2]*f+i[2]*h,e}function Ue(e,t){t=t||1;let n=2*p()*Math.PI,r=2*p()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e}function ze(e,t,n){let r=t[0],i=t[1],a=t[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,e[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,e[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,e}function qe(e,t,n){let r=t[0],i=t[1],a=t[2];return e[0]=r*n[0]+i*n[3]+a*n[6],e[1]=r*n[1]+i*n[4]+a*n[7],e[2]=r*n[2]+i*n[5]+a*n[8],e}function He(e,t,n){let r=n[0],i=n[1],a=n[2],o=n[3],s=t[0],u=t[1],l=t[2],c=i*l-a*u,f=a*s-r*l,h=r*u-i*s,d=i*h-a*f,p=a*c-r*h,m=r*f-i*c,b=2*o;return c*=b,f*=b,h*=b,d*=2,p*=2,m*=2,e[0]=s+c+d,e[1]=u+f+p,e[2]=l+h+m,e}function Ge(e,t,n,r){let i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function Xe(e,t,n,r){let i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function Ye(e,t,n,r){let i=[],a=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],e[0]=a[0]+n[0],e[1]=a[1]+n[1],e[2]=a[2]+n[2],e}function We(e,t){let n=me(e[0],e[1],e[2]),r=me(t[0],t[1],t[2]);Be(n,n),Be(r,r);let i=Ce(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}function je(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Ke(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Qe(e,t){let n=e[0],r=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(n-a)<=h*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=h*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=h*Math.max(1,Math.abs(i),Math.abs(s))}const Ze=Me,$e=ye,Je=xe,et=we,tt=Le,nt=pe,rt=Ne,it=function(){let e=he();return function(t,n,r,i,a,o){let s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}();function at(){let e=new d(4);return d!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function ot(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function st(e,t,n){n*=.5;let r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function ut(e,t){let n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>h?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function lt(e,t,n){let r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],u=n[1],l=n[2],c=n[3];return e[0]=r*c+o*s+i*l-a*u,e[1]=i*c+o*u+a*s-r*l,e[2]=a*c+o*l+r*u-i*s,e[3]=o*c-r*s-i*u-a*l,e}function ct(e,t,n){n*=.5;let r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+o*s,e[1]=i*u+a*s,e[2]=a*u-i*s,e[3]=o*u-r*s,e}function ft(e,t,n){n*=.5;let r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u-a*s,e[1]=i*u+o*s,e[2]=a*u+r*s,e[3]=o*u-i*s,e}function ht(e,t,n){n*=.5;let r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+i*s,e[1]=i*u-r*s,e[2]=a*u+o*s,e[3]=o*u-a*s,e}function dt(e,t){let n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e}function pt(e,t,n,r){let i,a,o,s,u,l=t[0],c=t[1],f=t[2],d=t[3],p=n[0],m=n[1],b=n[2],v=n[3];return(a=l*p+c*m+f*b+d*v)<0&&(a=-a,p=-p,m=-m,b=-b,v=-v),1-a>h?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-r)*i)/o,u=Math.sin(r*i)/o):(s=1-r,u=r),e[0]=s*l+u*p,e[1]=s*c+u*m,e[2]=s*f+u*b,e[3]=s*d+u*v,e}function mt(e){let t=p(),n=p(),r=p(),i=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=a*Math.sin(2*Math.PI*r),e[3]=a*Math.cos(2*Math.PI*r),e}function bt(e,t){let n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=a*s,e}function vt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function gt(e,t){let n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{let r=0;t[4]>t[0]&&(r=1),t[8]>t[3*r+r]&&(r=2);let i=(r+1)%3,a=(r+2)%3;n=Math.sqrt(t[3*r+r]-t[3*i+i]-t[3*a+a]+1),e[r]=.5*n,n=.5/n,e[3]=(t[3*i+a]-t[3*a+i])*n,e[i]=(t[3*i+r]+t[3*r+i])*n,e[a]=(t[3*a+r]+t[3*r+a])*n}return e}function Mt(e,t,n,r){let i=.5*Math.PI/180;t*=i,n*=i,r*=i;let a=Math.sin(t),o=Math.cos(t),s=Math.sin(n),u=Math.cos(n),l=Math.sin(r),c=Math.cos(r);return e[0]=a*u*c-o*s*l,e[1]=o*s*c+a*u*l,e[2]=o*u*l-a*s*c,e[3]=o*u*c+a*s*l,e}function yt(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}!function(){let e=new d(4);d!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();const xt=function(e){let t=new d(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},At=function(e,t,n,r){let i=new d(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},_t=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Tt=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},Et=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},Rt=lt,St=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},It=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},wt=function(e,t,n,r){let i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=a+r*(n[1]-a),e[2]=o+r*(n[2]-o),e[3]=s+r*(n[3]-s),e},Lt=function(e){let t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},Nt=Lt,Ot=function(e){let t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i},Ft=Ot,Bt=function(e,t){let n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=a*o),e},Ct=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},Pt=function(e,t){let n=e[0],r=e[1],i=e[2],a=e[3],o=t[0],s=t[1],u=t[2],l=t[3];return Math.abs(n-o)<=h*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=h*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=h*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-l)<=h*Math.max(1,Math.abs(a),Math.abs(l))},kt=function(){let e=he(),t=me(1,0,0),n=me(0,1,0);return function(r,i,a){let o=Ce(i,a);return o<-.999999?(Pe(e,t,i),nt(e)<1e-6&&Pe(e,n,i),Be(e,e),st(r,e,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Pe(e,i,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+o,Bt(r,r))}}(),Vt=function(){let e=at(),t=at();return function(n,r,i,a,o,s){return pt(e,r,o,s),pt(t,i,a,s),pt(n,e,t,2*s*(1-s)),n}}(),Dt=function(){let e=function(){let e=new d(9);return d!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Bt(t,gt(t,e))}}(),Ut=-90,zt=0,qt=.005,Ht=.05,Gt=45;class Xt{constructor(e=a.fromValues(0,0,0),t=a.fromValues(0,1,0),n=Ut,r=zt,i=a.fromValues(0,0,-1),o=qt,s=Ht,u=Gt){this.position=e,this.worldUp=t,this.yaw=n,this.pitch=r,this.front=i,this.right=a.fromValues(1,0,0),this.up=a.fromValues(0,1,0),this.movementSpeed=o,this.mouseSensitivity=s,this.zoom=u,this.updateCameraVectors()}getViewMatrix(){let e=i.create(),t=a.create();return a.add(t,this.position,this.front),i.lookAt(e,this.position,t,this.up),e}processMove(e,t){let n=this.movementSpeed*t,r=a.create();e==Xt.Movement.FORWARD&&(a.scale(r,this.front,n),a.add(this.position,this.position,r)),e==Xt.Movement.BACKWARD&&(a.scale(r,this.front,n),a.sub(this.position,this.position,r)),e==Xt.Movement.LEFT&&(a.scale(r,this.right,n),a.sub(this.position,this.position,r)),e==Xt.Movement.RIGHT&&(a.scale(r,this.right,n),a.add(this.position,this.position,r)),e==Xt.Movement.UP&&(a.scale(r,this.up,n),a.add(this.position,this.position,r)),e==Xt.Movement.DOWN&&(a.scale(r,this.up,n),a.sub(this.position,this.position,r))}processViewAngle(e,t,n=!0){e*=this.mouseSensitivity,t*=this.mouseSensitivity,this.yaw+=e,this.pitch+=t,n&&(this.pitch>89&&(this.pitch=89),this.pitch<-89&&(this.pitch=-89)),this.updateCameraVectors()}processZoom(e){this.zoom>=1&&this.zoom<=45&&(this.zoom-=e/200),this.zoom<=1&&(this.zoom=1),this.zoom>=45&&(this.zoom=45)}updateCameraVectors(){let e=a.create();e[0]=Math.cos(r.toRadian(this.yaw))*Math.cos(r.toRadian(this.pitch)),e[1]=Math.sin(r.toRadian(this.pitch)),e[2]=Math.sin(r.toRadian(this.yaw))*Math.cos(r.toRadian(this.pitch)),a.normalize(this.front,e);let t=a.create();a.cross(t,this.front,this.worldUp),a.normalize(this.right,t);let n=a.create();a.cross(n,this.right,this.front),a.normalize(this.up,n)}desktopFreeMoveControl(e,t=["w","s","a","d"," ","Shift"]){e.currentlyPressedKeys.get(t[0])&&this.processMove(Xt.Movement.FORWARD,e.deltaTime),e.currentlyPressedKeys.get(t[1])&&this.processMove(Xt.Movement.BACKWARD,e.deltaTime),e.currentlyPressedKeys.get(t[2])&&this.processMove(Xt.Movement.LEFT,e.deltaTime),e.currentlyPressedKeys.get(t[3])&&this.processMove(Xt.Movement.RIGHT,e.deltaTime),e.currentlyPressedKeys.get(t[4])&&this.processMove(Xt.Movement.UP,e.deltaTime),e.currentlyPressedKeys.get(t[5])&&this.processMove(Xt.Movement.DOWN,e.deltaTime),this.processViewAngle(e.mouseInput.deltaX,-e.mouseInput.deltaY),this.processZoom(e.mouseInput.wheelDeltaY)}}Xt.Movement={FORWARD:0,BACKWARD:1,LEFT:2,RIGHT:3,UP:4,DOWN:5};var Yt=Xt,Wt=n(1),jt=n.n(Wt),Kt=n(2),Qt=n.n(Kt);const Zt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},$t={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};var Jt=class{constructor(e,t,n=[]){if(!e||!e.asset)throw Error("Invalid gltf object");Object.assign(this,e),this.binFiles=t,this.images=n}initMeshBuffers(e,t){e.primitives.forEach(e=>{e.indices.buffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.indices.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,e.indices.bufferData,t.STATIC_DRAW),e.vao=t.createVertexArray(),t.bindVertexArray(e.vao),Object.keys(e.attributes).forEach(n=>{let r=e.attributes[n];r.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.bufferData(t.ARRAY_BUFFER,r.bufferData,t.STATIC_DRAW);let i=t.getAttribLocation(e.shader.program,"a_"+n.toLowerCase());t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.vertexAttribPointer(i,r.itemSize,r.componentType,!1,0,0),t.enableVertexAttribArray(i)})})}initMesh(e,t){let n=e.primitives.length;for(let r=0;r<n;r++){let n=e.primitives[r],i="#version 300 es\n"+n.getDefines();n.shader=new u(t,i+jt.a,i+Qt.a)}this.initMeshBuffers(e,t);for(let r=0;r<n;r++){let n=e.primitives[r];void 0!==n.material&&this.initMaterial(n.material,t)}}initMaterial(e,t){if(e.loaded)return;e.loaded=!0;let n=function(e,t,n){void 0===e.texture&&(e.texture=t.createTexture(),t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_2D,e.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e.source),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR))};if(void 0!==e.pbrMetallicRoughness){let r=e.pbrMetallicRoughness;void 0!==r.baseColorTexture&&n(r.baseColorTexture,t,0),void 0!==r.metallicRoughnessTexture&&n(r.metallicRoughnessTexture,t,1)}void 0!==e.normalTexture&&n(e.normalTexture,t,2),void 0!==e.emissiveTexture&&n(e.emissiveTexture,t,3)}useMaterial(e,t,n){n.setInt("u_BaseColorSampler",0),n.setInt("u_MetallicRoughnessSampler",1),n.setInt("u_NormalSampler",2),n.setInt("u_EmissiveSampler",3),n.setVec3("u_EmissiveFactor",e.emissiveFactor);let r=function(e,t,n){t.activeTexture(t.TEXTURE0+n),t.bindTexture(t.TEXTURE_2D,e.texture)};if(void 0!==e.pbrMetallicRoughness){let i=e.pbrMetallicRoughness;n.setVec4("u_BaseColorFactor",i.baseColorFactor),n.setVec2("u_MetallicRoughnessValues",[i.metallicFactor,i.roughnessFactor]),void 0!==i.baseColorTexture&&r(i.baseColorTexture,t,0),void 0!==i.metallicRoughnessTexture&&r(i.metallicRoughnessTexture,t,1)}void 0!==e.normalTexture&&(n.setFloat("u_NormalScale",e.normalTexture.scale),r(e.normalTexture,t,2)),void 0!==e.emissiveTexture&&r(e.emissiveTexture,t,3)}initScene(e,t){e.nodes.forEach(e=>{this.initNode(e,t)})}initNode(e,t){void 0!==e.mesh&&this.initMesh(e.mesh,t),void 0!==e.children&&e.children.forEach(e=>{this.initNode(e,t)})}loadAnimation(e,t){let n=this.animations[e];return n.id===e?n:(n.id=e,n.samplers.forEach(e=>{e.input=this.accessData(e.input),e.output=this.accessData(e.output)}),n.channels.forEach(e=>{e.sampler=n.samplers[e.sampler],e.target.node=this.findNode(e.target.node,t)}),n)}findNode(e,t){let n,r=t.nodes.length;for(let i=0;i<r&&void 0===(n=this._findNode(t.nodes[i],e));i++);return n}_findNode(e,t){if(e.id===t)return e;if(void 0!==e.children){let n,r=e.children.length;for(let i=0;i<r&&void 0===(n=this._findNode(e.children[i],t));i++);return n}}getCurrentValue(e,t){let n,r,i=t.input.bufferData.reduce((t,n,r)=>n>t&&n<e?n:t),s=t.input.bufferData.reduce((t,n)=>n>e&&t>e?n<t?n:t:n>e?n:t),u=t.output.itemSize,l=t.input.bufferData.indexOf(i),c=t.input.bufferData.indexOf(s);if(1==u)n=t.output.bufferData[l],r=t.output.bufferData[c];else if(n=[],r=[],"CUBICSPLINE"===t.interpolation)for(let e=0;e<3*u;e++)n[e]=t.output.bufferData[l*u*3+e],r[e]=t.output.bufferData[c*u*3+e];else for(let e=0;e<u;e++)n[e]=t.output.bufferData[l*u+e],r[e]=t.output.bufferData[c*u+e];let f,h=(e-i)/(s-i);if(4===u)f=o.create(),o.slerp(f,n,r,h);else if(f=[],"LINEAR"===t.interpolation)for(let e=0;e<u;e++)f[e]=n[e]+h*(r[e]-n[e]);else if("STEP"===t.interpolation)for(let e=0;e<u;e++)f[e]=n[e];else if("CUBICSPLINE"===t.interpolation){let e=[],t=[],o=[],l=[];for(let a=0;a<u;a++)e[a]=n[u+a],t[a]=r[u+a],o[a]=(s-i)*n[2*u+a],l[a]=(s-i)*r[a];f=a.create();let c=h;a.scaleAndAdd(f,f,e,2*c**3-3*c**2+1),a.scaleAndAdd(f,f,o,c**3-2*c**2+c),a.scaleAndAdd(f,f,t,-2*c**3+3*c**2),a.scaleAndAdd(f,f,l,c**3-c**2)}return f}loadMaterial(e,t){let n=this.materials[e];if(n.id===e)return t.defines=Object.assign(t.defines,n.defines),n;n.id=e,n.defines={};let r=this,i=function(e){isNaN(e.source)||(e.source=r.images[e.source])};if(void 0!==n.pbrMetallicRoughness){let e=n.pbrMetallicRoughness;void 0!==e.baseColorTexture&&(n.defines.HAS_BASECOLORMAP=1,e.baseColorTexture=this.textures[e.baseColorTexture.index],i(e.baseColorTexture)),void 0!==e.metallicRoughnessTexture&&(n.defines.HAS_METALROUGHNESSMAP=1,e.metallicRoughnessTexture=this.textures[e.metallicRoughnessTexture.index],i(e.metallicRoughnessTexture)),void 0===e.metallicFactor&&(e.metallicFactor=1),void 0===e.roughnessFactor&&(e.roughnessFactor=1),void 0===e.baseColorFactor&&(e.baseColorFactor=[1,1,1,1])}return void 0!==n.normalTexture&&(n.defines.HAS_NORMALMAP=1,n.normalTexture=this.textures[n.normalTexture.index],i(n.normalTexture),void 0===n.normalTexture.scale&&(n.normalTexture.scale=1)),void 0!==n.emissiveTexture&&(n.defines.HAS_EMISSIVEMAP=1,n.emissiveTexture=this.textures[n.emissiveTexture.index],i(n.emissiveTexture)),void 0===n.emissiveFactor&&(n.emissiveFactor=[0,0,0]),void 0===n.alphaMode&&(n.alphaMode="OPAQUE"),void 0===n.alphaCutoff&&(n.alphaCutoff=.5),void 0===n.doubleSided&&(n.doubleSided=!1),t.defines=Object.assign(t.defines,n.defines),n}loadMesh(e){let t=this.meshes[e];if(t.id===e)return t;t.id=e;let n=t.primitives.length;for(let e=0;e<n;e++){let n=t.primitives[e];n.defines={},n.indices=this.accessData(n.indices),Object.keys(n.attributes).forEach(e=>{let t=this.accessData(n.attributes[e]);switch(n.attributes[e]=t,e){case"NORMAL":n.defines.HAS_NORMALS=1;break;case"TANGENT":n.defines.HAS_TANGENTS=1;break;case"TEXCOORD_0":n.defines.HAS_UV=1}}),void 0!==n.material&&(n.material=this.loadMaterial(n.material,n)),n.getDefines=function(){return function(e){let t="";for(let n in e)t+="#define "+n+" "+e[n]+"\n";return t}(this.defines)}}return t}loadScene(e){let t=this.scenes[e];if(t.id===e)return node;if(t.id=e,void 0!==t.nodes){let e=t.nodes.slice();t.nodes=[],e.forEach(e=>{t.nodes.push(this.loadNode(e))})}return t}loadNode(e){let t=this.nodes[e];if(t.id===e)return t;if(t.id=e,void 0===t.matrix){if(t.matrix=i.create(),t.translation&&i.translate(t.matrix,t.matrix,t.translation),t.rotation){let e=i.create();i.fromQuat(e,t.rotation),i.mul(t.matrix,t.matrix,e)}t.scale&&i.scale(t.matrix,t.matrix,t.scale)}return void 0!==t.mesh&&(t.mesh=this.loadMesh(t.mesh)),void 0!==t.children&&t.children.forEach((e,n)=>{t.children[n]=this.loadNode(e)}),t}accessData(e){let t=this.accessors[e];if(t.id===e)return t;t.id=e;let n,r,i=this.bufferViews[t.bufferView],a=this.binFiles[i.buffer],o=Zt[t.componentType].BYTES_PER_ELEMENT*$t[t.type],s=Zt[t.componentType];return n=0,r=t.count*o,void 0!==i.byteOffset&&(n+=i.byteOffset,r+=i.byteOffset),t.itemSize=$t[t.type],t.bufferData=new s(a.slice(n,r)),t}},en=n(3),tn=n.n(en),nn=n(4),rn=n.n(nn),an=n(5),on=n.n(an),sn=n(6),un=n.n(sn),ln=n(7),cn=n.n(ln),fn=n(8),hn=n.n(fn),dn=n(9),pn=n.n(dn);let mn=new f({width:960,height:540,desktopInput:{lockPointer:!0}});document.body.appendChild(mn.el);let bn=mn.gl;bn.enable(bn.DEPTH_TEST),bn.enable(bn.CULL_FACE);let vn=new Yt(a.fromValues(0,0,5));!async function(){let e,t,n=await function(e,t){return new Promise((t,n)=>{let r=new XMLHttpRequest,i=!1;r.open("GET",e,!0),r.responseType="arraybuffer",r.onprogress=function(e){e.lengthComputable?Math.round(e.loaded/e.total*100):i||(i=!0)},r.onloadend=function(){r.status.toString().match(/^2/)?t(this.response):n(r)},r.send()})}(rn.a),a=[on.a,pn.a,hn.a,cn.a,un.a].map((e,t)=>f.loadImage(e,()=>{})),o=await Promise.all(a),s=new Jt(tn.a,[n],o),u=s.loadScene(0);s.initScene(u,bn),console.log("scene:",u),void 0!==s.animations&&s.animations.forEach((e,t)=>{s.loadAnimation(t,u)}),mn.start(),bn.clearColor(0,0,0,1),mn.draw=(n=>{vn.desktopFreeMoveControl(mn),bn.clear(bn.COLOR_BUFFER_BIT|bn.DEPTH_BUFFER_BIT),e=vn.getViewMatrix(),t=i.create(),i.perspective(t,r.toRadian(vn.zoom),bn.canvas.clientWidth/bn.canvas.clientHeight,.1,100),u.nodes.forEach(r=>{let a=i.create();i.scale(a,a,[100,100,100]),function r(a,o){if(i.mul(o,o,a.matrix),void 0!==s.animations&&s.animations.forEach(e=>{e.channels.forEach(e=>{if(a.id===e.target.node.id){let t=e.sampler.input.max[0]-e.sampler.input.min[0],r=s.getCurrentValue(n/1e3%t,e.sampler);if("scale"===e.target.path)i.scale(o,o,r);else if("translation"===e.target.path)i.translate(o,o,r);else if("rotation"===e.target.path){let e=i.create();i.fromQuat(e,r),i.mul(o,o,e)}}})}),void 0!==a.mesh){let n=i.create(),r=i.create();i.multiply(n,e,o),i.multiply(r,t,n);let u=i.create(),l=i.create();i.invert(u,o),i.transpose(l,u),a.mesh.primitives.forEach(e=>{e.shader.use(),e.shader.setVec3("u_LightDirection",[3,5,4]),e.shader.setVec3("u_LightColor",[1,1,1]),e.shader.setVec3("u_Camera",vn.position),e.shader.setMat4("u_MVPMatrix",r),e.shader.setMat4("u_ModelMatrix",o),e.shader.setMat4("u_NormalMatrix",l),void 0!==e.material&&s.useMaterial(e.material,bn,e.shader),bn.bindVertexArray(e.vao),bn.bindBuffer(bn.ELEMENT_ARRAY_BUFFER,e.indices.buffer),bn.drawElements(bn.TRIANGLES,e.indices.count,e.indices.componentType,0)})}void 0!==a.children&&a.children.forEach(e=>{let t=i.create();i.copy(t,o),r(e,t)})}(r,a)})})}()}]);